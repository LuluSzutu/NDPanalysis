# NDPanalysis
NDPanalysis : a system for fully automated quantification and quick analysis of large-scale activity induced IEG images by using MATLAB and MATLAB distributed computing server. 

Fluorescence in situ hybridization (FISH) of neural activity-related immediate-early gene (IEG, e.g. Arc and Homer 1a) expression is currently combined with confocal microscopy to determine patterns of recent neural activity. However, due to image acquisition and analysis time, this approach is severely restricted in terms of the amount of brain tissue that can be analysed. We are assessing the use of an automated scanning microscope (Hamamatsu NanoZoomer 2.0-RS, Olympus) which is capable of automatically capturing wide field multi-spectral fluorescent image stacks over entire brain sections at high resolution in a relatively short period of time. Such image data sets can be as large as 8GB after compression,  and are stored in a special image format - NDPI.  At present, there is no software tool that is able to read and process such large image data sets.

We developed a comprehensive software tool - NDPanalysis - to process very large-scale, multi-spectral images or image stacks acquired by Nanozoomer microscope using a less precise, but much faster approach ('quick and dirty'). This GUI software platform is able to load the whole image dataset onto the computer and display in relative lower resolution. Users can select ROI, rotate the image and do basic measurement and analysis on this low magnification image. Because of the memory limits that MATLAB can handle, the very large-scale images or image stacks were decompressed and decomposed into sub-images or sub-image stacks, and were then processed in each sub-image or sub-image stacks to obtain the information demanded by the users. This information includes estimated nuclei number, intra-nuclear foci number and location, etc.. The counterstained nuclei number can be simply estimated by calculating the number of pixels on the nuclear channel after removing the low intensity background noise and high intensity glial nuclei. The main steps of quantification of the intra-nuclear foci are color-shift compensation, FISH signal extraction and foci correction algorithm whose aim is to remove outer-nuclear signals and to separate overlap. The numerical analysis results for each sub-image or sub-image stack is then corrected and the foci location is transformed into the original image or image stack. When two (or possibly more) kinds of FISH signals are imaged, this program can simply estimate the number of cells that are singly labelled (Arc or H1a) or double labelled (Arc and H1a) by defined nearest-neighbor pairs of blobs within-color (singly labelled) and then cross-color (double labelled), without segmenting or counting nuclei. 

The current code is in Matlab and is interfaced with C/C++. The MATLAB Parallel Computing Toolbox as well as the MATLAB distributed computing system are used to speed up processing time and handle large datasets. It takes about 1.5 hours processing time for 15 layers of a whole brain coronal section (about 13mm x 9mm) on a 100 computer cluster.
